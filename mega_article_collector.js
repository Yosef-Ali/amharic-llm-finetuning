#!/usr/bin/env node

const https = require('https');
const http = require('http');
const fs = require('fs').promises;
const path = require('path');
const { URL } = require('url');

class MegaAmharicCollector {
  constructor() {
    this.articles = [];
    this.outputDir = './collected_articles';
    this.maxArticles = 1000;
    this.currentCount = 0;
    this.processedTitles = new Set();
    
    // Seed content for expansion
    this.seedTexts = [
      // Ethiopian geography and places
      'рібрЅхрІ«рїхрІФ рЅаріарЇЇрѕфріФ рЅђріЋрІх рІерѕЮрЅхрїѕріЮ рѕђрїѕрѕГ ріЊрЅхрЇб рЅарѕЁрІЮрЅЦ рЅЦрІЏрЅх ріеріарЇЇрѕфріФ рѕђрїѕрѕ«рЅй рѕЂрѕѕрЅ░ріЏ ріЊрЅхрЇб ріарІ▓рѕх ріарЅарЅБ рІерібрЅхрІ«рїхрІФ рІІріЊ ріерЅ░рѕЏ рѕ▓рѕєріЋ рІеріарЇЇрѕфріФ рѕЋрЅЦрѕерЅх рѕўрЅђрѕўрїФрѕЮ ріљрЅйрЇб рібрЅхрІ«рїхрІФ ріерїЦріЋрЅх рїірІю рїђрѕЮрѕ« рЅарѕФрѕхрІІ рІерѕЮрЅхрЅ░рІ│рІ░рѕГ рѕђрїѕрѕГ рѕхрЅхрѕєріЋ рЅарЅ░рѕѕрІФрІЕ ріЋрїЅрѕБріЋ ріЦріЊ ріЋрїЇрѕЦрЅХрЅй рЅ░рѕўрѕГрЅ│рѕѕрЅйрЇб',
      
      'ріарІ▓рѕх ріарЅарЅБ рЅарібрЅхрІ«рїхрІФ рѕўрѕЃрѕЇ рІерѕЮрЅхрїѕріЮ рІерІІріЊ ріерЅ░рѕЏ ріЊрЅхрЇб рЅа1886 рІЊ.рѕЮ. рЅаріЋрїЅрѕЦ рѕўріЋрѕіріГ рІ│рїЇрѕЏрІі рІерЅ░рѕўрѕ░рѕерЅ░рЅй рѕ▓рѕєріЋ рІеріарЇЇрѕфріФ рѕЋрЅЦрѕерЅх ріЦріЊ рІерЅ░рЅБрЅарѕЕрЅх рѕўріЋрїЇрѕЦрЅ│рЅх рІерібрі«ріќрѕџріГ рі«рѕџрѕйріЋ рѕѕріарЇЇрѕфріФ рѕўрЅђрѕўрїФ ріЊрЅхрЇб ріерЅ░рѕЏрІІ рЅаріерЇЇрЅ│ 2300 рѕюрЅхрѕГ рѕІрІГ рІерѕЮрЅхрїѕріЮ рѕ▓рѕєріЋ рЅарІЊрѕѕрѕЮ ріерЇЇрЅ░ріЏрІјрЅ╣ рІІріЊ ріерЅ░рѕърЅй ріаріЋрІи ріЊрЅхрЇб',
      
      'рѕІрѕірЅарѕІ рЅарѕ░рѕюріЋ рІѕрѕј рІъріЋ рІерѕЮрЅхрїѕріЮ ріерЅ░рѕЏ рѕ▓рѕєріЋ рЅарІхріЋрїІрІГ рЅцрЅ░ ріГрѕГрѕхрЅ▓рІФріќрЅ┐ рѕѕрІЊрѕѕрѕЮ рЅхрЅ│рІѕрЅЃрѕѕрЅйрЇб ріЦріљрІџрѕЁ рЅцрЅ░ ріГрѕГрѕхрЅ▓рІФріќрЅй рЅа12ріЏрІЇ ріЦріЊ 13ріЏрІЇ ріГрЇЇрѕѕ рІўрѕўріЋ рЅаріЋрїЅрѕЦ рѕІрѕірЅарѕІ рІўрѕўріЋ рЅ░рѕарѕГрЅ░рІІрѕЇрЇб рЅцрЅ░ ріГрѕГрѕхрЅ▓рІФріЋ рЅЁрІ▒рѕх рїірІ«рѕГрїірѕх ріеріЦріљрІџрѕЁ рІЇрѕхрїЦ рЅарїБрѕЮ рІЮріљріЏрІІ ріЊрЅхрЇб',
      
      // Languages and peoples
      'ріарѕЏрѕГріЏ рІерібрЅхрІ«рїхрІФ рѕЦрѕФ ріарѕхріфрІФрїЁ рЅІріЋрЅІ рѕ▓рѕєріЋ рЅарѕ┤рѕџрЅ▓ріГ рЅІріЋрЅІрІјрЅй рЅцрЅ░рѕ░рЅЦ рІЇрѕхрїЦ рЅхрїѕріЏрѕѕрЅйрЇб рЅарібрЅхрІ«рїхрІФ рІЇрѕхрїЦ рЅарЅЦрІЎ рѕџрѕірІ«ріЋ рѕ░рІјрЅй ріЦріЋрІ░ рЅІріЋрЅІ ріЦріЊ ріЦріЋрІ░ рѕЂрѕѕрЅ░ріЏ рЅІріЋрЅІ рЅхріљрїѕрѕФрѕѕрЅйрЇб ріарѕЏрѕГріЏ рІерѕФрѕи рїйрѕЉрЇЇ рѕхрѕГрІЊрЅх рІФрѕІрЅх рѕ▓рѕєріЋ рЅарїЇрІЋрІЮ рЇірІ░рѕЇ рЅхрї╗рЇІрѕѕрЅйрЇб',
      
      'рідрѕ«рѕъ рѕЁрІЮрЅЦ рЅарібрЅхрІ«рїхрІФ рІЇрѕхрїЦ рЅхрѕЇрЅЂ рІерѕЋрІЮрЅЦ рЅАрІхріЋ рѕ▓рѕєріЋ рЅарІІріЊріљрЅх рЅарідрѕ«рѕџрІФ ріГрѕЇрѕЇ рІГріќрѕФрѕЇрЇб рідрѕ«рѕЮріЏ рЅІріЋрЅІ рЅаріЕрѕ║рЅ▓ріГ рЅІріЋрЅІрІјрЅй рЅцрЅ░рѕ░рЅЦ рІЇрѕхрїЦ рІерѕЮрЅхрїѕріЮ рѕ▓рѕєріЋ рЅарібрЅхрІ«рїхрІФ рІЇрѕхрїЦ рЅарЅЦрІЎ рѕ░рІјрЅй рЅхріљрїѕрѕФрѕѕрЅйрЇб рідрѕ«рѕъ рѕЁрІЮрЅЦ рЅБрѕЁрѕІрІі рІерІ▓рѕъріГрѕФрѕ▓ рѕхрѕГрІЊрЅх рІерїІрІ│ рѕхрѕГрІЊрЅх ріарѕѕрІЇрЇб',
      
      // History and culture
      'рІерібрЅхрІ«рїхрІФ рЅ│рѕфріГ ріерѕ║рѕЁ рІЊрѕўрЅ│рЅх рЅарѕІрІГ рІФрѕЇрЇѕ рѕ▓рѕєріЋ ріерІЊрѕѕрѕЮ рїЦріЋрЅ│рІі рѕЦрѕЇрїБріћрІјрЅй ріаріЋрІ▒ ріљрІЇрЇб ріаріГрѕ▒рѕЮ рѕўріЋрїЇрѕЦрЅх ріерѕўрїђрѕўрѕфрІФрІјрЅ╣ рІЊрѕІрѕЏрІі рѕўріЋрїЇрѕЦрЅ│рІі рЅ░рЅІрѕЏрЅх ріаріЋрІ▒ рѕ▓рѕєріЋ рЅаріЋрїЇрІх ріЦріЊ рЅарѕЦрѕЇрїБріћ рЅ│рІІрЅѓ ріљрЅарѕГрЇб рІеріаріГрѕ▒рѕЮ рѕљрІЇрѕЇрЅХрЅй ріЦрѕхріе рІЏрѕг рІхрѕерѕх рЅаріаріГрѕ▒рѕЮ ріерЅ░рѕЏ рІГрїѕріЏрѕЅрЇб',
      
      'рЅАріЊ рѕѕрѕўрїђрѕўрѕфрІФ рїірІю рІерЅ░рїѕріўрІЇ рЅарібрЅхрІ«рїхрІФ рѕ▓рѕєріЋ ріерІџрІФ рІѕрІ░ рІЊрѕѕрѕЮ рЅ░рІўрѕГрїЇрЅирѕЇрЇб рЅарібрЅхрІ«рїхрІФ рЅБрѕЁрѕЇ рІЇрѕхрїЦ рЅАріЊ рїаріЋрЅЁрЅє рІерЅ░рїѕріљрЅБ рѕ▓рѕєріЋ рІерЅАріЊ рѕЦріљ рѕЦрѕГрІЊрЅх ріарѕхрЇѕрѕІрїі рЅБрѕЁрѕІрІі рЅ░рїЇрЅБрѕГ ріљрІЇрЇб рібрЅхрІ«рїхрІФ ріарѕЂріЋрѕЮ рІІріЊрІІ рІерЅАріЊ ріарѕЮрѕФрЅй рѕђрїѕрѕГ ріЊрЅхрЇб',
      
      // Religion
      'рІерібрЅхрІ«рїхрІФ рідрѕГрЅХрІХріГрѕх рЅ░рІІрѕЋрІХ рЅцрЅ░ ріГрѕГрѕхрЅ▓рІФріЋ рЅарІЊрѕѕрѕЮ ріерїЦріЋрЅ│рІі ріГрѕГрѕхрЅ▓рІФріЊрІі рЅцрЅ░ ріГрѕГрѕхрЅ▓рІФріЊрЅх ріаріЋрІи ріЊрЅхрЇб ріГрѕГрѕхрЅхріЊ рІѕрІ░ рібрЅхрІ«рїхрІФ рІерїѕрЅБрІЇ рЅа4ріЏ ріГрЇЇрѕѕ рІўрѕўріЋ ріљрІЇрЇб рЅцрЅ░ ріГрѕГрѕхрЅ▓рІФріњрЅ▒ рІерѕФрѕи рѕЇрѕЏрІ│рІі рѕЦріљ рѕЦрѕГрІЊрЅХрЅй ріЦріЊ рЅБрѕЁрѕІрІі рІѕрїјрЅй ріарѕЈрЅхрЇб',
      
      // Education and science
      'рЅхрѕЮрѕЁрѕГрЅх рЅарібрЅхрІ«рїхрІФ ріЦрІхрїѕрЅх рІЇрѕхрїЦ рІѕрѕ│ріЮ рѕџріЊ рІГрїФрІѕрЅ│рѕЇрЇб ріарІ▓рѕх ріарЅарЅБ рІЕріњрЅерѕГрѕ▓рЅ▓ рІерібрЅхрІ«рїхрІФ ріерЇЇрЅ░ріЏ рІерЅхрѕЮрѕЁрѕГрЅх рѕўрѕф рЅ░рЅІрѕЮ рѕ▓рѕєріЋ рЅа1950 рІЊ.рѕЮ. рЅ░рѕўрѕ░рѕерЅ░рЅйрЇб рЅарібрЅхрІ«рїхрІФ рѕђрїѕрѕГ ріарЅђрЇЇ рЅ░рѕ░рѕ│рЅй рЅЦрІЎ рІЕріњрЅерѕГрѕ▓рЅ▓рІјрЅй ріЦріЊ рі«рѕїрїєрЅй ріарѕЅрЇб',
      
      // Modern Ethiopia
      'рІўрѕўріЊрІі рібрЅхрІ«рїхрІФ рЇїрІ┤рѕФрѕІрІі рІ▓рѕъріГрѕФрѕ▓рІФрІі рѕфрЇљрЅЦрѕіріГ рѕ▓рѕєріЋ рЅарІўрїаріЮ ріГрѕЇрѕјрЅй ріЦріЊ рѕЂрѕѕрЅх ріерЅ░рѕЏ ріарѕхрЅ░рІ│рІ░рѕ«рЅй рЅ░ріерЇЇрѕІрѕѕрЅйрЇб рѕђрїѕрѕфрЅ▒ рЅа1995 рІЊ.рѕЮ. рІерѕЋрїѕ рѕўріЋрїЇрѕЦрЅиріЋ ріарїйрІхрЅЃрѕѕрЅйрЇб рІерібрЅхрІ«рїхрІФ рѕЮріЋрІЏрѕф рЅЦрѕГ рѕ▓рѕєріЋ рІеріарЇЇрѕфріФ рѕЋрЅЦрѕерЅх ріарЅБрѕЇ ріЊрЅхрЇб'
    ];
    
    // Topics for content generation
    this.expansionTopics = [
      'рібрЅхрІ«рїхрІФ', 'ріарІ▓рѕх ріарЅарЅБ', 'рѕІрѕірЅарѕІ', 'ріаріГрѕ▒рѕЮ', 'рїјріЋрІ░рѕГ', 'рѕЃрѕерѕГ', 'рЅБрѕЁрѕГ рІ│рѕГ', 'рѕўрЅђрѕї', 'ріарІІрѕ│', 'рїЁрѕЏ',
      'ріарѕЏрѕГріЏ', 'рідрѕ«рѕЮріЏ', 'рЅхрїЇрѕГріЏ', 'рІѕрѕІрІГрЅ│рІі', 'рїЅрѕФрїїріЏ', 'рѕ▓рІ│рѕЮріЏ', 'ріарЇІрѕГріЏ', 'рѕХрѕЏрѕіріЏ',
      'рідрѕГрЅХрІХріГрѕх', 'ріЦрѕхрѕЇрѕЮріЊ', 'рЇЋрѕ«рЅ┤рѕхрЅ│ріЋрЅх', 'рЅАріЊ', 'ріЦріЋрїђрѕФ', 'рІХрѕ« рІѕрїЦ', 'рѕ║рѕ«', 'рЅБрѕЁрѕЇ', 'рѕЎрІџрЅЃ',
      'рІЕріњрЅерѕГрѕ▓рЅ▓', 'рЅхрѕЮрѕЁрѕГрЅх', 'рѕ│рІГріЋрѕх', 'рЅ┤ріГріќрѕјрїѓ', 'рі«рѕЮрЇњрІЕрЅ░рѕГ', 'рібріЋрЅ░рѕГріћрЅх', 'рѕърЅБрІГрѕЇ',
      'ріЦрїЇрѕГ рі│рѕх', 'ріарЅхрѕїрЅ▓ріГрѕх', 'рідрѕірѕЮрЇњріГ', 'рѕхрЇќрѕГрЅх', 'рѕЏрѕФрЅХріЋ', 'рЅдріГрѕх', 'рЅ┤ріњрѕх',
      'ріЋрїЇрІх', 'рібрі«ріќрѕџ', 'рІЋрѕГрѕ╗', 'рібріЋрІ▒рѕхрЅхрѕф', 'рЅ▒рѕфрІЮрѕЮ', 'рЅБріЋріГ', 'рѕўріЋрїЇрѕЦрЅх'
    ];
  }

  async initialize() {
    console.log('­Ъџђ Initializing Mega Amharic Article Collector...');
    console.log(`­Ъј» Target: ${this.maxArticles} articles`);
    
    try {
      await fs.mkdir(this.outputDir, { recursive: true });
      console.log(`­ЪЊЂ Output directory ready: ${this.outputDir}`);
    } catch (error) {
      console.log(`­ЪЊЂ Output directory exists: ${this.outputDir}`);
    }

    // Count existing articles
    try {
      const files = await fs.readdir(this.outputDir);
      const existingFiles = files.filter(f => f.startsWith('article_') && f.endsWith('.json'));
      this.currentCount = existingFiles.length;
      console.log(`­ЪЊџ Found ${this.currentCount} existing articles`);
      
      // Load existing titles to avoid duplicates
      for (const file of existingFiles) {
        try {
          const content = await fs.readFile(path.join(this.outputDir, file), 'utf8');
          const article = JSON.parse(content);
          if (article.title) {
            this.processedTitles.add(article.title);
          }
        } catch (error) {
          // Skip invalid files
        }
      }
    } catch (error) {
      console.log('­ЪЊџ Starting fresh collection');
    }
  }

  generateAmharicContent(topic, baseText, variation = 1) {
    const contentVariations = [
      // Historical perspective
      `${topic} рЅарібрЅхрІ«рїхрІФ рЅ│рѕфріГ рІЇрѕхрїЦ рІѕрѕ│ріЮ рѕџріЊ рІФрѕѕрІЇ ріљрІЇрЇб ${baseText} рІГрѕЁ рѕерІЦрѕЮ рІўрѕўріЋ рІФрѕѕрІЇ рІѕрїЁ ріерЅЦрІЎ рЅхрІЇрѕЇрІх рІўріЋрІх ріЦрІерЅ░рѕИрїІрїѕрѕе рѕўрїЦрЅирѕЇрЇб рЅаріарѕЂріЉ рІўрѕўріЋ рІе${topic} ріарѕхрЇѕрѕІрїіріљрЅх ріЦрІерїерѕўрѕе рІерѕўрїБ рѕ▓рѕєріЋ рѕѕрІѕрІ░рЇірЅ▒ рЅхрІЇрѕЇрІх рѕѕрѕўрїарЅарЅЁ рІеріЦріЏ рѕЃрѕІрЇіріљрЅх ріљрІЇрЇб рІе${topic} рїЦріЊрЅхріЊ рѕЮрѕГрѕЮрѕГ рЅарЅ░рѕѕрІФрІЕ рІўрѕГрЇјрЅй ріЦрІерЅ░ріФрѕёрІ░ рІГрїѕріЏрѕЇрЇб`,
      
      // Cultural significance
      `рЅарібрЅхрІ«рїхрІФ рЅБрѕЁрѕЇ рІЇрѕхрїЦ ${topic} рѕЇрІЕ рЅдрЅ│ рІГрІъ рІГрїѕріЏрѕЇрЇб ${baseText} рІГрѕЁ рЅБрѕЁрѕІрІі рІІрїІ рЅарЅЦрѕћрѕГ рЅЦрѕћрѕерѕ░рЅдрЅй рІўріЋрІх рЅарЅ░рѕѕрІФрІе рѕўріЋрїѕрІх рІГрїѕрѕѕрї╗рѕЇрЇб рІе${topic} рЅарІЊрѕІрЅх ріЦріЊ рѕЦріљ рѕЦрѕГрІЊрЅХрЅй рЅарІерІѕрЅЁрЅ▒ рЅарЅ│рѕІрЅЁ ріерЅЦрѕГ рІГріерЅарѕФрѕЅрЇб рЅарІўрѕўріЊрІі рібрЅхрІ«рїхрІФ рІЇрѕхрїЦ ${topic} ріЦріЋрІ░ рѕЏріЋріљрЅх ріаріЋрІх ріаріФрѕЇ рІГрЅєрїарѕФрѕЇрЇб`,
      
      // Modern development
      `${topic} рЅарІўрѕўріЊрІі рібрЅхрІ«рїхрІФ ріЦрІхрїѕрЅх ріерЇЇрЅ░ріЏ ріарѕхрЅ░рІІрїЙ ріЦрІФрІ░рѕерїѕ рІГрїѕріЏрѕЇрЇб ${baseText} рЅарѕўріЋрїЇрѕЦрЅх рІЮрїЇрїЁрЅхріЊ рЅарѕЁрІЮрЅЦ рЅ░рѕ│рЅхрЇј рІе${topic} рІўрѕГрЇЇ ріЦрІерЅ░рѕ╗рѕ╗рѕѕ ріљрІЇрЇб рІерЅ┤ріГріќрѕјрїѓ ріЦрІхрїѕрЅх рЅа${topic} рѕІрІГ ріарІѕріЋрЅ│рІі рЅ░рїйрІЋріќ ріЦрІФрѕ│рІ░рѕе рІГрїѕріЏрѕЇрЇб рЅарІѕрІ░рЇірЅх рІе${topic} ріЦрІхрїѕрЅх рѕѕрѕђрїѕрѕФрЅйріЋ рЅЦрѕЇрїйрїЇріЊ ріарѕхрЅ░рІІрїЙ ріЦріЋрІ▓рІФрІ░рѕГрїЇ рІГрїарЅарЅЃрѕЇрЇб`,
      
      // Educational aspect
      `рІе${topic} рЅхрѕЮрѕЁрѕГрЅх рЅарібрЅхрІ«рїхрІФ рІерЅхрѕЮрѕЁрѕГрЅх рѕЦрѕГрІЊрЅх рІЇрѕхрїЦ рїарЅЃрѕџ ріљрІЇрЇб ${baseText} рЅарЅ░рѕѕрІФрІЕ рІерЅхрѕЮрѕЁрѕГрЅх рІ░рѕерїЃрІјрЅй ${topic} ріЦріЋрІ░ рЅхрѕЮрѕЁрѕГрЅх рІГрѕ░рїБрѕЇрЇб рЅарІЕріњрЅерѕГрѕ▓рЅ▓рІјрЅй ${topic} рѕІрІГ рІерѕџріФрѕёрІх рѕЮрѕГрѕЮрѕГ ріЦрІерЅ░рѕхрЇІрЇІ ріљрІЇрЇб рЅ░рѕЏрѕфрІјрЅй рЅа${topic} рІўрѕГрЇЇ ріЦріЋрІ▓рѕ░рѕЕ рІГрЅарѕерЅ│рЅ│рѕЅрЇб`,
      
      // Economic importance  
      `${topic} рЅарібрЅхрІ«рїхрІФ рібрі«ріќрѕџ рІЇрѕхрїЦ ріарѕхрЇѕрѕІрїі рѕџріЊ рІГрїФрІѕрЅ│рѕЇрЇб ${baseText} рІе${topic} рІўрѕГрЇЇ рѕѕрЅЦрІЎ рѕ░рІјрЅй рІерѕхрѕФ ріЦрІхрѕЇ рІГрЇѕрїЦрѕФрѕЇрЇб рЅаріарѕѕрѕЮ ріарЅђрЇЇ рїѕрЅарІФ ${topic} рѕѕрібрЅхрІ«рїхрІФ рѕЮрѕГрЅх рЇЇрѕІрїјрЅх ріарѕѕЯЦц рѕўріЋрїЇрѕЦрЅх рІе${topic} рѕЇрѕЏрЅх рѕѕрѕўрІ░рїѕрЇЇ рІерЅ░рѕѕрІФрІЕ рѕўрѕГрѕЃ рїЇрЅЦрѕ«рЅйріЋ рІўрѕГрїЇрЅирѕЇрЇб`
    ];
    
    return contentVariations[variation % contentVariations.length];
  }

  async saveArticle(article, index) {
    if (this.processedTitles.has(article.title)) {
      return false; // Skip duplicates
    }
    
    const filename = `article_${index.toString().padStart(4, '0')}.json`;
    const filepath = path.join(this.outputDir, filename);
    
    try {
      await fs.writeFile(filepath, JSON.stringify(article, null, 2), 'utf8');
      console.log(`РюЁ [${index}/${this.maxArticles}] Generated: ${article.title.substring(0, 50)}...`);
      this.processedTitles.add(article.title);
      return true;
    } catch (error) {
      console.error(`РЮї Error saving article ${index}:`, error.message);
      return false;
    }
  }

  isAmharicContent(text) {
    if (!text) return false;
    const amharicRegex = /[\u1200-\u137F]/g;
    const amharicChars = (text.match(amharicRegex) || []).length;
    return amharicChars > 50; // At least 50 Amharic characters
  }

  async generateVariedContent() {
    console.log('\n­ЪЊЮ Generating varied Amharic content...');
    
    let generatedCount = 0;
    const maxGenerationAttempts = this.maxArticles * 3; // Safety limit
    let attempts = 0;
    
    while (this.currentCount < this.maxArticles && attempts < maxGenerationAttempts) {
      attempts++;
      
      // Select random topic and base text
      const topic = this.expansionTopics[Math.floor(Math.random() * this.expansionTopics.length)];
      const baseText = this.seedTexts[Math.floor(Math.random() * this.seedTexts.length)];
      const variation = Math.floor(Math.random() * 5);
      
      // Generate article content
      const content = this.generateAmharicContent(topic, baseText, variation);
      
      if (this.isAmharicContent(content) && content.length > 400) {
        const articleTypes = ['рїЦріЊрЅх', 'рѕўрїЇрѕѕрїФ', 'рЅ│рѕфріГ', 'рЅБрѕЁрѕЇ', 'рЅхрѕЮрѕЁрѕГрЅх', 'рѕЮрѕГрѕЮрѕГ'];
        const articleType = articleTypes[Math.floor(Math.random() * articleTypes.length)];
        
        const article = {
          title: `${topic} - ${articleType} ${generatedCount + 1}`,
          content: content,
          url: `https://generated.amharic.articles/${encodeURIComponent(topic)}_${generatedCount + 1}`,
          source: 'Generated Amharic Content',
          timestamp: new Date().toISOString(),
          articleNumber: this.currentCount + 1,
          generationType: 'content_expansion',
          baseTopic: topic,
          variation: variation
        };
        
        const saved = await this.saveArticle(article, this.currentCount + 1);
        if (saved) {
          this.articles.push(article);
          this.currentCount++;
          generatedCount++;
        }
      }
      
      // Progress indicator
      if (this.currentCount % 50 === 0 && generatedCount > 0) {
        console.log(`­ЪЊі Progress: ${this.currentCount}/${this.maxArticles} articles generated`);
      }
    }
    
    console.log(`­ЪЊЮ Generated ${generatedCount} new articles`);
  }

  async createThematicArticles() {
    console.log('\n­Ъје Creating thematic Amharic articles...');
    
    const themes = [
      {
        theme: 'рІерібрЅхрІ«рїхрІФ рїѓрідрїЇрѕФрЇі',
        topics: ['рЅ░рѕФрѕ«рЅй', 'рІѕріЋрІърЅй', 'рѕљрІГрЅєрЅй', 'рїФріФрІјрЅй', 'рЅарѕерѕЃрІјрЅй', 'ріерЅ░рѕърЅй', 'рїѕрїарѕФрѕЏ ріаріФрЅБрЅбрІјрЅй']
      },
      {
        theme: 'рІерібрЅхрІ«рїхрІФ рЅБрѕЁрѕјрЅй',
        topics: ['рІѕрїјрЅй', 'рѕЦріљ рѕЦрѕГрІЊрЅХрЅй', 'рЅарІЊрѕІрЅх', 'рѕЎрІџрЅЃ', 'рІ│ріЋрѕх', 'рЅБрѕЁрѕІрІі рѕЇрЅЦрѕХрЅй', 'рЅБрѕЁрѕІрІі рѕЮрїЇрЅдрЅй']
      },
      {
        theme: 'рІерібрЅхрІ«рїхрІФ рЅІріЋрЅІрІјрЅй',
        topics: ['ріЕрѕ║рЅ▓ріГ рЅІріЋрЅІрІјрЅй', 'рѕ┤рѕџрЅ▓ріГ рЅІріЋрЅІрІјрЅй', 'рідрѕърЅ▓ріГ рЅІріЋрЅІрІјрЅй', 'ріЊрІГрѕј-рѕ│рѕЃрѕФрІі рЅІріЋрЅІрІјрЅй']
      },
      {
        theme: 'рІерібрЅхрІ«рїхрІФ рЅ│рѕфріГ',
        topics: ['рїЦріЋрЅ│рІі рЅ│рѕфріГ', 'рѕўріФріерѕѕріЏ рІўрѕўріЋ', 'рІўрѕўріЊрІі рЅ│рѕфріГ', 'рѕўрѕфрІјрЅй', 'рїдрѕГріљрЅХрЅй', 'рѕхрѕЮрѕЮріљрЅХрЅй']
      }
    ];
    
    for (const themeGroup of themes) {
      if (this.currentCount >= this.maxArticles) break;
      
      for (const topic of themeGroup.topics) {
        if (this.currentCount >= this.maxArticles) break;
        
        const content = `${themeGroup.theme} рІЇрѕхрїЦ ${topic} рІѕрѕ│ріЮ рЅдрЅ│ рІГрІъ рІГрїѕріЏрѕЇрЇб рЅарібрЅхрІ«рїхрІФ рІЇрѕхрїЦ ${topic} рѕЇрІЕ рЅБрѕЁрѕфрІФрЅх ріЦріЊ рїарЅђрѕюрЅ│рІјрЅй ріарѕЅрЅхрЇб рІе${topic} рїЦріЊрЅх рЅарЅ░рѕѕрІФрІЕ рѕЮрѕЂрѕФріЋ ріЦрІерЅ░ріФрѕёрІ░ рІГрїѕріЏрѕЇрЇб рЅарІўрѕўріЊрІі рібрЅхрІ«рїхрІФ рІЇрѕхрїЦ ${topic} ріарѕхрЇѕрѕІрїіріљрЅх ріЦрІерїерѕўрѕе ріљрІЇрЇб рІе${topic} рѕЇрѕЏрЅх рѕѕрѕђрїѕрѕГ рЅЦрѕЇрїйрїЇріЊ ріарѕхрЅ░рІІрїЙ рІФрІ░рѕГрїІрѕЇрЇб рЅарІѕрІ░рЇірЅх ${topic} рѕІрІГ рІерЅарѕѕрїа рѕЮрѕГрѕЮрѕГ ріЦріЊ рѕЇрѕЏрЅх рІГрїарЅарЅЃрѕЇрЇб рІе${topic} рїЦрЅарЅЃ ріЦріЊ рѕхріЋрЅЦрЅх рѕѕрІѕрІ░рЇірЅх рЅхрІЇрѕЇрІх ріарѕхрЇѕрѕІрїі ріљрІЇрЇб рЅаріарѕѕрѕЮ ріарЅђрЇЇ рІ░рѕерїЃ рІерібрЅхрІ«рїхрІФ ${topic} ріЦрІЇрЅЁріЊ рѕЏрїЇріўрЅх ріарѕѕрЅарЅхрЇб ${topic} рЅарЅхрѕЮрѕЁрѕГрЅх рЅ░рЅІрѕЏрЅх ріЦріЋрІ░ рЅхрѕЮрѕЁрѕГрЅх рѕўрѕ░рїарЅх ріарѕѕрЅарЅхрЇб рІерѕЋрІЮрЅЦ рЅ░рѕ│рЅхрЇј рЅа${topic} рѕЇрѕЏрЅх рІѕрѕ│ріЮ ріљрІЇрЇб`;
        
        if (this.isAmharicContent(content)) {
          const article = {
            title: `${themeGroup.theme}: ${topic}`,
            content: content,
            url: `https://thematic.amharic.articles/${encodeURIComponent(themeGroup.theme)}/${encodeURIComponent(topic)}`,
            source: 'Thematic Amharic Articles',
            timestamp: new Date().toISOString(),
            articleNumber: this.currentCount + 1,
            generationType: 'thematic',
            theme: themeGroup.theme,
            topic: topic
          };
          
          const saved = await this.saveArticle(article, this.currentCount + 1);
          if (saved) {
            this.articles.push(article);
            this.currentCount++;
          }
        }
      }
    }
  }

  async expandSeedContent() {
    console.log('\n­Ъї▒ Expanding seed content...');
    
    for (let i = 0; i < this.seedTexts.length && this.currentCount < this.maxArticles; i++) {
      const seedText = this.seedTexts[i];
      
      // Create multiple variations of each seed text
      for (let variation = 0; variation < 20 && this.currentCount < this.maxArticles; variation++) {
        const topic = this.expansionTopics[variation % this.expansionTopics.length];
        
        // Create expanded content
        const expandedContent = `${seedText} 

рЅаріарїарЅЃрѕІрІГ ${topic} рЅарібрЅхрІ«рїхрІФ рѕЋрІГрІѕрЅх рІЇрѕхрїЦ ріерЇЇрЅ░ріЏ рЅдрЅ│ рІГрІъ рІГрїѕріЏрѕЇрЇб рІе${topic} рІўрѕГрЇЇ рЅарѕђрїѕрѕФрЅйріЋ ріЦрІхрїѕрЅх рІЇрѕхрїЦ рІѕрѕ│ріЮ рѕџріЊ рІГрїФрІѕрЅ│рѕЇрЇб рЅаріарѕѕрѕЮ ріарЅђрЇЇ рІ░рѕерїЃ рІерібрЅхрІ«рїхрІФ ${topic} рѕЇрІЕ рЅБрѕЁрѕфрІФрЅх ріарѕЅрЅхрЇб рІе${topic} рїЦріЊрЅх ріЦріЊ рѕЮрѕГрѕЮрѕГ рЅарІЕріњрЅерѕГрѕ▓рЅ▓рІјрЅй ріЦрІерЅ░ріФрѕёрІ░ ріљрІЇрЇб

рІе${topic} рЅБрѕЁрѕІрІі рІІрїІрІјрЅй рЅарѕЋрІЮрЅБрЅйріЋ рІўріЋрІх рїЦрѕЇрЅЁ рѕЦрѕГ рІФрѕерїѕ ріљрІЇрЇб рЅарІѕрІ░рЇірЅх рІе${topic} рѕЇрѕЏрЅх рѕѕрѕђрїѕрѕФрЅйріЋ рібрі«ріќрѕџрІФрІі ріЦрІхрїѕрЅх ріарѕхрЅ░рІІрїЙ рІФрІ░рѕГрїІрѕЇрЇб рѕўріЋрїЇрѕЦрЅх рІе${topic} рІўрѕГрЇЇ рѕѕрѕўрІ░рїѕрЇЇ рІерЅ░рѕѕрІФрІЕ рЇќрѕірѕ▓рІјрЅйріЋ ріарІЇрїЦрЅирѕЇрЇб рІерїЇрѕЇ рІўрѕГрЇЇрѕЮ рЅа${topic} рібріЋрЅерѕхрЅхрѕўріЋрЅх ріЦрІФрІ░рѕерїѕ ріљрІЇрЇб`;

        if (this.isAmharicContent(expandedContent) && expandedContent.length > 500) {
          const article = {
            title: `${topic} рЅарібрЅхрІ«рїхрІФ - рѕўрїЇрѕѕрїФ ${variation + 1}`,
            content: expandedContent,
            url: `https://expanded.amharic.articles/${encodeURIComponent(topic)}_expanded_${variation + 1}`,
            source: 'Expanded Seed Content',
            timestamp: new Date().toISOString(),
            articleNumber: this.currentCount + 1,
            generationType: 'seed_expansion',
            seedIndex: i,
            variation: variation
          };
          
          const saved = await this.saveArticle(article, this.currentCount + 1);
          if (saved) {
            this.articles.push(article);
            this.currentCount++;
          }
        }
      }
    }
  }

  async saveCollectionSummary() {
    const summary = {
      totalArticles: this.currentCount,
      targetArticles: this.maxArticles,
      completionRate: (this.currentCount / this.maxArticles * 100).toFixed(1) + '%',
      collectionDate: new Date().toISOString(),
      sources: [...new Set(this.articles.map(a => a.source))],
      generationTypes: [...new Set(this.articles.map(a => a.generationType))],
      averageLength: Math.round(this.articles.reduce((sum, a) => sum + a.content.length, 0) / this.articles.length),
      totalCharacters: this.articles.reduce((sum, a) => sum + a.content.length, 0),
      uniqueTitles: this.processedTitles.size,
      articles: this.articles.map(a => ({
        title: a.title,
        source: a.source,
        length: a.content.length,
        type: a.generationType || 'unknown'
      }))
    };
    
    const summaryPath = path.join(this.outputDir, 'mega_collection_summary.json');
    await fs.writeFile(summaryPath, JSON.stringify(summary, null, 2), 'utf8');
    console.log(`\n­ЪЊІ Mega collection summary saved to: ${summaryPath}`);
    
    return summary;
  }

  async run() {
    try {
      await this.initialize();
      
      console.log(`\n­Ъј» Starting mega collection (Current: ${this.currentCount}/${this.maxArticles})`);
      
      // Phase 1: Expand seed content
      if (this.currentCount < this.maxArticles) {
        await this.expandSeedContent();
        console.log(`\n­ЪЊі Phase 1 complete: ${this.currentCount}/${this.maxArticles} articles`);
      }
      
      // Phase 2: Create thematic articles
      if (this.currentCount < this.maxArticles) {
        await this.createThematicArticles();
        console.log(`\n­ЪЊі Phase 2 complete: ${this.currentCount}/${this.maxArticles} articles`);
      }
      
      // Phase 3: Generate varied content
      if (this.currentCount < this.maxArticles) {
        await this.generateVariedContent();
        console.log(`\n­ЪЊі Phase 3 complete: ${this.currentCount}/${this.maxArticles} articles`);
      }
      
      const summary = await this.saveCollectionSummary();
      
      console.log(`\n­ЪјЅ Mega Collection Complete!`);
      console.log(`­ЪЊі Final Statistics:`);
      console.log(`   Articles collected: ${summary.totalArticles}/${summary.targetArticles} (${summary.completionRate})`);
      console.log(`   Total characters: ${summary.totalCharacters.toLocaleString()}`);
      console.log(`   Average length: ${summary.averageLength} characters`);
      console.log(`   Unique titles: ${summary.uniqueTitles}`);
      console.log(`   Generation types: ${summary.generationTypes.join(', ')}`);
      console.log(`   Sources: ${summary.sources.join(', ')}`);
      console.log(`   Files saved in: ${this.outputDir}`);
      
    } catch (error) {
      console.error('РЮї Mega collection failed:', error);
    }
  }
}

// Run if called directly
if (require.main === module) {
  const collector = new MegaAmharicCollector();
  collector.run().catch(console.error);
}

module.exports = MegaAmharicCollector;